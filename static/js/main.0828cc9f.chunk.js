(this.webpackJsonpmesto=this.webpackJsonpmesto||[]).push([[0],{11:function(e,t,a){e.exports=a(17)},16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(6),o=a.n(c),i=(a(16),a(10)),s=a(3),l=a(1),u=a(7),p=a.n(u);var d=function(e){return r.a.createElement("header",{className:"header"},r.a.createElement("a",{href:"https://realmxs.github.io/mesto-react/"},r.a.createElement("img",{className:"logo",src:p.a,alt:"Mesto Russia",lang:"en"})))},m=r.a.createContext();var _=function(e){var t=r.a.useContext(m),a=e.card,n=e.card.owner._id===t._id,c="card__delete-button ".concat(n?"card__delete-button_active":"card__delete-button_inactive"),o=e.card.likes.some((function(e){return e._id===t._id})),i="card__like-button ".concat(o?"card__like-button_active":"card__like-button_inactive");return r.a.createElement("div",{className:"card"},r.a.createElement("img",{onClick:function(){e.click(a)},className:"card__image",alt:"\u0444\u043e\u0442\u043e",src:a.link}),r.a.createElement("button",{onClick:function(){e.onCardDelete(a)},className:c}),r.a.createElement("div",{className:"card__info"},r.a.createElement("h2",{className:"card__title"},a.name),r.a.createElement("div",{className:"card__like-wrapper"},r.a.createElement("button",{onClick:function(){e.onCardLike(a)},className:i,type:"button"}),r.a.createElement("p",{className:"card__like-counter"},a.likes.length))))};var f=function(e){var t=r.a.useContext(m);return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__container"},r.a.createElement("button",{onClick:e.editAvatar,className:"profile__avatar-button"},r.a.createElement("img",{className:"profile__avatar",alt:"\u0412\u0430\u0448\u0435 \u0444\u043e\u0442\u043e",src:t.avatar})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",{className:"profile__wrapper"},r.a.createElement("h1",{className:"profile__title"},t.name),r.a.createElement("button",{className:"profile__edit-button",type:"button",onClick:e.editProfile})),r.a.createElement("p",{className:"profile__subtitle"},t.about))),r.a.createElement("button",{className:"open-newcard-popup-button",onClick:e.addPlace})),r.a.createElement("section",{className:"cards-container"},e.cards.map((function(t){return r.a.createElement(_,{key:t._id,card:t,click:e.showPic,onCardLike:e.handleCardLike,onCardDelete:e.handleCardDelete})}))))};var h=function(e){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright",lang:"en"},"\xa92020 Mesto Russia"))};var v=function(e){return r.a.createElement("div",{className:"popup ".concat(e.isOpen&&"popup_opened"),id:"pic-popup"},r.a.createElement("div",{className:"popup__wrapper"},r.a.createElement("img",{className:"popup__image",alt:"\u0444\u043e\u0442\u043e",src:e.cardInfo.link}),r.a.createElement("button",{onClick:e.close,className:"popup__close-button",id:"close-picpopup",type:"button"}),r.a.createElement("h2",{className:"popup__image-title"},e.cardInfo.name)))};var E=function(e){return r.a.createElement("div",{className:"popup ".concat(e.isOpen&&"popup_opened"),id:e.id},r.a.createElement("form",{className:"popup__container popup__container_".concat(e.size),onSubmit:e.onSubmit,noValidate:!0},r.a.createElement("button",{className:"popup__close-button",id:"close-avatar-popup-button",type:"button",onClick:e.close}),r.a.createElement("h2",{className:"popup__title"},e.title),e.children,r.a.createElement("button",{className:"popup__submit-button",type:"submit"},e.submitButtonText)))};var b=function(e){var t=r.a.useContext(m),a=r.a.useState([]),n=Object(l.a)(a,2),c=n[0],o=n[1],i=r.a.useState([]),s=Object(l.a)(i,2),u=s[0],p=s[1];return r.a.useEffect((function(){o(t.name),p(t.about)}),[t]),r.a.createElement(E,{isOpen:e.isOpen,id:"profile-edit-popup",size:"large",title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435",close:e.onClose,submitButtonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(t){t.preventDefault(),e.onUserUpdate(c,u),t.target.reset()}},r.a.createElement("fieldset",{className:"popup__fieldset"},r.a.createElement("div",{className:"popup__input-wrapper"},r.a.createElement("input",{type:"text",value:c||"",placeholder:"\u0418\u043c\u044f",className:"popup__input",id:"input-profile-title",minLength:"2",maxLength:"40",pattern:"[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\s\\-]{1,}",onChange:function(e){o(e.target.value)},required:!0}),r.a.createElement("span",{className:"popup__error-text",id:"input-profile-title-error"})),r.a.createElement("div",{className:"popup__input-wrapper"},r.a.createElement("input",{type:"text",value:u||"",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__input",id:"input-profile-subtitle",minLength:"2",maxLength:"200",onChange:function(e){p(e.target.value)},required:!0}),r.a.createElement("span",{className:"popup__error-text",id:"input-profile-subtitle-error"}))))};var N=function(e){var t=r.a.useRef();return r.a.createElement(E,{isOpen:e.isOpen,id:"avatar-popup",size:"medium",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",close:e.onClose,submitButtonText:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",onSubmit:function(a){a.preventDefault(),e.onAvatarUpdate(t.current.value),a.target.reset()}},r.a.createElement("div",{className:"popup__input-wrapper"},r.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",className:"popup__input",id:"input-avatar-link",ref:t,required:!0}),r.a.createElement("span",{className:"popup__error-text",id:"input-avatar-link-error"})))};var g=function(e){var t=r.a.useRef(),a=r.a.useRef();return r.a.createElement(E,{isOpen:e.isOpen,id:"newcard-popup",size:"large",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e",close:e.onClose,submitButtonText:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onSubmit:function(n){n.preventDefault(),e.onAddPlace(t.current.value,a.current.value),n.target.reset()}},r.a.createElement("fieldset",{className:"popup__fieldset"},r.a.createElement("div",{className:"popup__input-wrapper"},r.a.createElement("input",{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input",id:"input-card-title",minLength:"1",maxLength:"30",ref:t,required:!0}),r.a.createElement("span",{className:"popup__error-text",id:"input-card-title-error"})),r.a.createElement("div",{className:"popup__input-wrapper"},r.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input",id:"input-card-link",ref:a,required:!0}),r.a.createElement("span",{className:"popup__error-text",id:"input-card-link-error"}))))},k=a(8),C=a(9),O=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(k.a)(this,e),this._baseUrl=a,this._headers=n}return Object(C.a)(e,[{key:"_response",value:function(e){return e.ok?e.json():Promise.reject("error".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._response)}},{key:"getDefaultCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._response)}},{key:"updateUserInfo",value:function(e,t){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._response)}},{key:"addNewPlace",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._response)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._response)}},{key:"changeCardLikeStatus",value:function(e,t){var a=!0===t?"PUT":"DELETE";return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:a,headers:this._headers}).then(this._response)}},{key:"setUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._response)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12",headers:{authorization:"246d132c-15dc-4567-a2e3-3aa37ea260d6","Content-Type":"application/json"}});var y=function(){var e=r.a.useState(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],c=r.a.useState(!1),o=Object(l.a)(c,2),u=o[0],p=o[1],_=r.a.useState(!1),E=Object(l.a)(_,2),k=E[0],C=E[1],y=r.a.useState(!1),w=Object(l.a)(y,2),U=w[0],x=w[1],S=r.a.useState({}),j=Object(l.a)(S,2),P=j[0],L=j[1],A=r.a.useState({}),D=Object(l.a)(A,2),T=D[0],I=D[1],z=r.a.useState([]),B=Object(l.a)(z,2),q=B[0],J=B[1];function R(){n(!1),p(!1),C(!1),x(!1)}return r.a.useEffect((function(){O.getUserInfo().then((function(e){I(e)})).catch((function(e){console.log(e)}))}),[]),r.a.useEffect((function(){O.getDefaultCards().then((function(e){J(e)})).catch((function(e){console.log(e)}))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(m.Provider,{value:T},r.a.createElement(d,null),r.a.createElement(f,{editAvatar:function(){n(!0)},editProfile:function(){p(!0)},addPlace:function(){C(!0)},showPic:function(e){x(!0),L(e)},cards:q,handleCardLike:function(e){var t=e.likes.some((function(e){return e._id===T._id}));O.changeCardLikeStatus(e._id,!t).then((function(t){var a=q.map((function(a){return a._id===e._id?t:a}));J(a)}))},handleCardDelete:function(e){O.deleteCard(e._id).then((function(){var t=q.filter((function(t){return e._id!==t._id}));J(t)}))}}),r.a.createElement(h,null),r.a.createElement(N,{isOpen:a,onClose:R,onAvatarUpdate:function(e){O.setUserAvatar(e).then((function(e){I(Object(s.a)(Object(s.a)({},T),{},{avatar:e.avatar})),R()}))}}),r.a.createElement(b,{isOpen:u,onClose:R,onUserUpdate:function(e,t){O.updateUserInfo(e,t).then((function(e){I(Object(s.a)(Object(s.a)({},T),{},{name:e.name,about:e.about})),R()}))}}),r.a.createElement(g,{isOpen:k,onClose:R,onAddPlace:function(e,t){O.addNewPlace(e,t).then((function(e){J([e].concat(Object(i.a)(q))),R()}))}}),r.a.createElement(v,{isOpen:U,close:R,cardInfo:P})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){e.exports=a.p+"static/media/logo.697f7460.svg"}},[[11,1,2]]]);
//# sourceMappingURL=main.0828cc9f.chunk.js.map